/*
 * 갤러리 우측 로그인 박스 스크립트
 * 2018.02.05 - jhcho
 * 
 */

/*
 * 알림 리스트
 */

//알림 목록 레이어 열기/닫기
var alarmList = function(toggleElm, toggleClass) {
 if($('#alarmList').css('display') == 'none') {
	 login_box_layer_close();
 	
 	$('#alarmList').show();
 	
	$(toggleElm).removeClass(toggleClass);
	
	if(typeof(alarmClearNew) == 'function') {
		alarmClearNew();	// alarm_polling.js
	}
 }
 else {
 	alarmListClose();
 	alarmConfClose();
 }
};

//알림 목록 레이어 닫기
var alarmListClose = function() {
	$('#alarmList').hide();
};

///////////////////////////////////////////////////////////////////////////////

/*
 * 알림 설정
 */

// 알림 설정 레이어 열기/닫기
var alarmConf = function() {
    if($('#alarmConf').css('display') == 'none') {
    	login_box_layer_close();
    	$('#alarmConf').show();
    }
    else {
    	alarmConfClose();
    }
};

// 알림 on/off
var alarmConfToggle = function(elm) {
	if($(elm).hasClass('on')) {
		$(elm).removeClass('on');
		$('.blind', elm).text('off');
	}
	else {
		$(elm).addClass('on');
		$('.blind', elm).text('on');
	}
}

// 알림 설정 레이어 닫기
var alarmConfClose = function() {
	$('#alarmConf').hide();
};

// 알림 설정 저장
var alarmConfUpdate = function() {
	var conf = new Object;
	var csrf_token = get_cookie('ci_c');
	
	$('#alarmConf .setting_onoff > button').each(function() {
		var status = $(this).hasClass('on') ? 1 : 0;

		conf[$(this).attr('data-id')] = status;
	});
	
	if(Object.keys(conf).length > 0) {
		$.ajax({
			url: "//gall.dcinside.com/ajax/alarm_ajax/conf_update?jsoncallback=?",
			type : "GET",
			cache: false,
		    async: false,
		    dataType: 'json',
	        data : {
	            ci_t : csrf_token,
	            conf : conf
	        },
			success: function(res) {
				if(res === '0000') {
					alert('적용되었습니다.');
					alarmConfClose();
				}
				else {
					alert('일시적인 오류로 저장되지 않았습니다.');
				}
			}
		});
	}
};

// 우측 로그인박스 내 레이어 팝업 전체 닫기 (화살표 닫힘으로 변경 포함)
var login_box_layer_close = function() {
	$('.login_box .pop_wrap, .login_wrap .pop_wrap').hide();
	$('.login_box .icon_favorites').addClass('hide');
	$('.login_box .icon_admin').addClass('hide');
}